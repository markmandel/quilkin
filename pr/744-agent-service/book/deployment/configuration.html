<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Configuration - Quilkin Book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="../installation.html">Installation</a></li><li class="chapter-item expanded affix "><a href="../faq.html">FAQ</a></li><li class="chapter-item expanded affix "><li class="part-title">Quickstart Guides</li><li class="chapter-item expanded "><a href="../deployment/quickstarts/netcat.html"><strong aria-hidden="true">1.</strong> Netcat</a></li><li class="chapter-item expanded "><a href="../deployment/quickstarts/agones-xonotic-sidecar.html"><strong aria-hidden="true">2.</strong> Agones + Xonotic (Sidecar)</a></li><li class="chapter-item expanded "><a href="../deployment/quickstarts/agones-xonotic-xds.html"><strong aria-hidden="true">3.</strong> Agones + Xonotic (xDS)</a></li><li class="chapter-item expanded affix "><li class="part-title">Services</li><li class="chapter-item expanded "><a href="../services/proxy.html"><strong aria-hidden="true">4.</strong> Proxy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../services/proxy/qcmp.html"><strong aria-hidden="true">4.1.</strong> Control Message Protocol</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters.html"><strong aria-hidden="true">4.2.</strong> Filters</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../services/proxy/filters/capture.html"><strong aria-hidden="true">4.2.1.</strong> Capture</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/compress.html"><strong aria-hidden="true">4.2.2.</strong> Compress</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/concatenate_bytes.html"><strong aria-hidden="true">4.2.3.</strong> Concatenate Bytes</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/debug.html"><strong aria-hidden="true">4.2.4.</strong> Debug</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/drop.html"><strong aria-hidden="true">4.2.5.</strong> Drop</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/firewall.html"><strong aria-hidden="true">4.2.6.</strong> Firewall</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/load_balancer.html"><strong aria-hidden="true">4.2.7.</strong> Load Balancer</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/local_rate_limit.html"><strong aria-hidden="true">4.2.8.</strong> Local Rate Limit</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/match.html"><strong aria-hidden="true">4.2.9.</strong> Match</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/pass.html"><strong aria-hidden="true">4.2.10.</strong> Pass</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/timestamp.html"><strong aria-hidden="true">4.2.11.</strong> Timestamp</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/token_router.html"><strong aria-hidden="true">4.2.12.</strong> Token Router</a></li><li class="chapter-item expanded "><a href="../services/proxy/filters/writing_custom_filters.html"><strong aria-hidden="true">4.2.13.</strong> Writing Custom Filters</a></li></ol></li><li class="chapter-item expanded "><a href="../services/proxy/metrics.html"><strong aria-hidden="true">4.3.</strong> Metrics</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../services/xds.html"><strong aria-hidden="true">5.</strong> Control Plane</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../services/xds/metrics.html"><strong aria-hidden="true">5.1.</strong> Metrics</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.2.</strong> Providers</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../services/xds/providers/agones.html"><strong aria-hidden="true">5.2.1.</strong> Agones</a></li><li class="chapter-item expanded "><a href="../services/xds/providers/filesystem.html"><strong aria-hidden="true">5.2.2.</strong> Filesystem</a></li><li class="spacer"></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../services/relay.html"><strong aria-hidden="true">6.</strong> Relay</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.1.</strong> Metrics</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.2.</strong> Providers</div></li></ol></li><li class="chapter-item expanded "><li class="part-title">SDKs</li><li class="chapter-item expanded "><a href="../sdks/unreal-engine.html"><strong aria-hidden="true">7.</strong> Unreal Engine</a></li><li class="chapter-item expanded affix "><li class="part-title">Deployment</li><li class="chapter-item expanded "><a href="../deployment/admin.html"><strong aria-hidden="true">8.</strong> Administration</a></li><li class="chapter-item expanded "><a href="../deployment/examples.html"><strong aria-hidden="true">9.</strong> Architecture Examples</a></li><li class="chapter-item expanded "><a href="../deployment/configuration.html" class="active"><strong aria-hidden="true">10.</strong> Configuration</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Quilkin Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="configuration"><a class="header" href="#configuration">Configuration</a></h1>
<p>The following is the schema and reference for a Quilkin configuration
file. See the <a href="https://github.com/googleforgames/quilkin/blob/pr/744-agent-service/examples">examples</a> folder for example configuration files.</p>
<p>By default Quilkin will look for a configuration file named <code>quilkin.yaml</code> in
its current running directory first, then if not present, in
<code>/etc/quilkin/quilkin.yaml</code> on UNIX systems. This can be overridden with the
<code>-c/--config</code> command-line argument, or the <code>QUILKIN_FILENAME</code>
environment variable.</p>
<h2 id="static-configuration"><a class="header" href="#static-configuration">Static Configuration</a></h2>
<p>Example of a full configuration for <code>quilkin proxy</code> that utlisies a static
endpoint configuration:</p>
<pre><code class="language-yaml">#
# Example configuration for a Quilkin Proxy with static Endpoints
#

version: v1alpha1
id: my-proxy # An identifier for the proxy instance.
clusters: # grouping of clusters
  default:
    localities: # grouping of endpoints within a cluster
      - endpoints: # array of potential endpoints to send on traffic to
          - address: 127.0.0.1:26000
            metadata: # Metadata associated with the endpoint
              quilkin.dev:
                tokens:
                  - MXg3aWp5Ng== # the connection byte array to route to, encoded as base64 (string value: 1x7ijy6)
                  - OGdqM3YyaQ== # (string value: 8gj3v2i)
          - address: 127.0.0.1:26001
            metadata: # Metadata associated with the endpoint
              quilkin.dev:
                tokens:
                  - bmt1eTcweA== # (string value: nkuy70x)
</code></pre>
<h2 id="dynamic-configuration"><a class="header" href="#dynamic-configuration">Dynamic Configuration</a></h2>
<p>Example of a full configuration for <code>quilkin proxy</code> that utlisies a dynamic
Endpoint configuration through an <a href="../services/xds.html">xDS management endpoint</a>:</p>
<pre><code class="language-yaml">{{#include ../../../examples/control-plane.yaml:17:100}}
</code></pre>
<h2 id="json-schema"><a class="header" href="#json-schema">Json Schema</a></h2>
<p>The full <a href="https://json-schema.org/">JSON Schema</a> for the YAML configuration file.</p>
<pre><code class="language-yaml">type: object
properties:
  version:
    type: string
    description: |
      The configuration file version to use.
    enum:
      - v1alpha1
  id:
      type: string
      description: |
          An identifier for the proxy instance.
      default: On linux, the machine hostname is used as default. On all other platforms a UUID is generated for the proxy.
  port:
      type: integer
      description: |
          The listening port. In &quot;proxy&quot; mode, the port for traffic to be sent to. In &quot;manage&quot; mode, the port to connect to the xDS API.
      default: 7000
  maxmind_db:
    type: string
    description: |
      The remote URL or local file path to retrieve the Maxmind database (requires licence).
  filters:
    type: array
    description: |
      A filter chain.
    items:
      '$ref': {} # Refer to the Filter documentation for a filter configuration schema.
  clusters:
    type: object
    description: |
      grouping of clusters, each with a key for a name
    additionalProperties:
      type: object
      description: |
        An individual cluster
      properties:
        localities:          
          type: array
          description: |
            grouping of endpoints, per cluster.
          items:
            type: object
            properties:
              endpoints:
                type: array
                description: |
                  A list of upstream endpoints to forward packets to.
                items:
                  type: object
                  description: |
                    An upstream endpoint
                  properties:
                    address:
                      type: string
                      description: |
                        Socket address of the endpoint. This must be of the ´IP:Port` form e.g `192.168.1.1:7001`
                      metadata:
                        type: object
                        description: |
                          Arbitrary key value pairs that is associated with the endpoint.
                          These are visible to Filters when processing packets and can be used to provide more context about endpoints (e.g whether or not to route a packet to an endpoint).
                          Keys must be of type string otherwise the configuration is rejected.
                  required:
                    - address
  management_servers:
    type: array
    description: |
      A list of XDS management servers to fetch configuration from.
      Multiple servers can be provided for redundancy for the proxy to
      fall back to upon error.
    items:
      type: object
      description: |
        Configuration for a management server.
    properties:
      address:
        type: string
        description: |
          Address of the management server. This must have the `http(s)` scheme prefix.
          Example: `http://example.com`
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../deployment/examples.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../deployment/examples.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
